
##double check

**Using sample01 and 3DWFQ0404 as an example, SNPs were calculated separately for each comparison.

```
bcftools view -H -v snps sample01_DP10-20_GQ20.vcf.gz | wc -l
3612974

bcftools view -H -v snps 3DWFQ0404.filtered-DP20-40-GQ30.vcf.gz | wc -l
6452325
```

The results showed that sample01 contained 3,612,974 SNPs, whereas 3DWFQ0404 contained 6,452,325 SNPs. The number of shared sites (sites-compared) between the two samples was 1,924,395, and the number of sites skipped due to no match (sites-skipped-no-match) was 6,216,509.

Therefore, the number of SNPs unique to sample01 was calculated as 3,612,974 − 1,924,395 = 1,688,579, while the number of SNPs unique to 3DWFQ0404 was 6,452,325 − 1,924,395 = 4,527,930.

The total number of unique sites was 1,688,579 + 4,527,930 = 6,216,509, which is consistent with the value of sites-skipped-no-match (6,216,509).

Consequently, the total number of validated sites was calculated as the sum of sites-compared and sites-skipped-no-match:  
1,924,395 + 6,216,509 = 8,140,904.

 **SNPs were counted across all GATK-generated files.
```
 # Define sample array
samples=(
  3DWF22T0036 3DWF22T0070 3DWF22T0240 3DWF22T0415 3DWF22T0549
  3DWFN0018 3DWFP0355 3DWFP0398 3DWFP0413 3DWFQ0177
  3DWFQ0404 3DWFQ0458 3DWFQ0459 3DWFR0017 3DWFR0281
  3DWFS0069 3DWFS0123 3DWFS0137 3DWFS0202 WGWFL0149
)

# Write header to file
echo -e "Sample\tDP10-40-GQ20\tDP20-40-GQ30" > snp_counts.txt

# Loop through each sample and count SNPs in both files
for sample in "${samples[@]}"; do
  # Count SNPs in first file
  count1=$(bcftools view -H -v snps ${sample}.filtered-DP10-40-GQ20.vcf.gz | wc -l)
  
  # Count SNPs in second file
  count2=$(bcftools view -H -v snps ${sample}.filtered-DP20-40-GQ30.vcf.gz | wc -l)
  
  # Append results to file
  echo -e "${sample}\t${count1}\t${count2}" >> snp_counts_GATK.txt
done

echo "Statistics completed! Results saved in snp_counts_GATK.txt"
```

**SNPs were counted for all Clair3 output files.
```
# Read sample list from file
samples=$(cat sample.list)

# Write header to file
echo -e "Sample\tDP10-20-GQ20\tDP6-20-GQ10" > snp_counts_Claire3.txt

# Loop through each sample and count SNPs in both files
for sample in ${samples}; do
  # Count SNPs in first file
  count1=$(bcftools view -H -v snps ${sample}_DP10-20_GQ20.vcf.gz | wc -l)
  
  # Count SNPs in second file
  count2=$(bcftools view -H -v snps ${sample}_DP6-20_GQ10.vcf.gz | wc -l)
  
  # Append results to file
  echo -e "${sample}\t${count1}\t${count2}" >> snp_counts_Clair3.txt
done

echo "Statistics completed! Results saved in snp_counts_Clair3.txt"
```

**Unique SNPs were counted for each sample pair.
```
#!/bin/bash

# Output header
echo -e "Sample_Pair\tFilter_Combination\tSNP_unique_GATK\tSNP_unique_Clair3\tSites_Compared" > snp_unique_summary.txt

# Process gDP10-40-GQ20-cDP6-20-GQ10
while IFS=$'\t' read -r pair sites_compared sites_skipped rest; do
  if [[ "$pair" == "Sample_Pair" ]]; then continue; fi
  
  # Extract sample names
  gatk_sample=$(echo $pair | awk -F'_vs_' '{print $1}')
  clair3_sample=$(echo $pair | awk -F'_vs_' '{print $2}')
  
  # Get GATK SNP count (DP10-40-GQ20) - column 2
  gatk_snps=$(grep "^${gatk_sample}" snp_counts_GATK.txt | awk '{print $2}')
  
  # Get Clair3 SNP count (DP6-20-GQ10) - column 3
  clair3_snps=$(grep "^${clair3_sample}" snp_counts_Clair3.txt | awk '{print $3}')
  
  # Calculate unique SNPs
  gatk_unique=$((gatk_snps - sites_compared))
  clair3_unique=$((clair3_snps - sites_compared))
  
  echo -e "${pair}\tgDP10-40-GQ20_cDP6-20-GQ10\t${gatk_unique}\t${clair3_unique}\t${sites_compared}" >> snp_unique_summary.txt
done < gtcheck_summary-gDP10-40-GQ20-cDP6-20-GQ10.tsv

# Process gDP10-40-GQ20-cDP10-20-GQ20
while IFS=$'\t' read -r pair sites_compared sites_skipped rest; do
  if [[ "$pair" == "Sample_Pair" ]]; then continue; fi
  
  gatk_sample=$(echo $pair | awk -F'_vs_' '{print $1}')
  clair3_sample=$(echo $pair | awk -F'_vs_' '{print $2}')
  
  # GATK: DP10-40-GQ20 (column 2), Clair3: DP10-20-GQ20 (column 2)
  gatk_snps=$(grep "^${gatk_sample}" snp_counts_GATK.txt | awk '{print $2}')
  clair3_snps=$(grep "^${clair3_sample}" snp_counts_Clair3.txt | awk '{print $2}')
  
  gatk_unique=$((gatk_snps - sites_compared))
  clair3_unique=$((clair3_snps - sites_compared))
  
  echo -e "${pair}\tgDP10-40-GQ20_cDP10-20-GQ20\t${gatk_unique}\t${clair3_unique}\t${sites_compared}" >> snp_unique_summary.txt
done < gtcheck_summary-gDP10-40-GQ20-cDP10-20-GQ20.tsv

# Process gDP20-40-GQ30-cDP6-20-GQ10
while IFS=$'\t' read -r pair sites_compared sites_skipped rest; do
  if [[ "$pair" == "Sample_Pair" ]]; then continue; fi
  
  gatk_sample=$(echo $pair | awk -F'_vs_' '{print $1}')
  clair3_sample=$(echo $pair | awk -F'_vs_' '{print $2}')
  
  # GATK: DP20-40-GQ30 (column 3), Clair3: DP6-20-GQ10 (column 3)
  gatk_snps=$(grep "^${gatk_sample}" snp_counts_GATK.txt | awk '{print $3}')
  clair3_snps=$(grep "^${clair3_sample}" snp_counts_Clair3.txt | awk '{print $3}')
  
  gatk_unique=$((gatk_snps - sites_compared))
  clair3_unique=$((clair3_snps - sites_compared))
  
  echo -e "${pair}\tgDP20-40-GQ30_cDP6-20-GQ10\t${gatk_unique}\t${clair3_unique}\t${sites_compared}" >> snp_unique_summary.txt
done < gtcheck_summary-gDP20-40-GQ30-cDP6-20-GQ10.tsv

# Process gDP20-40-GQ30-cDP10-20-GQ20
while IFS=$'\t' read -r pair sites_compared sites_skipped rest; do
  if [[ "$pair" == "Sample_Pair" ]]; then continue; fi
  
  gatk_sample=$(echo $pair | awk -F'_vs_' '{print $1}')
  clair3_sample=$(echo $pair | awk -F'_vs_' '{print $2}')
  
  # GATK: DP20-40-GQ30 (column 3), Clair3: DP10-20-GQ20 (column 2)
  gatk_snps=$(grep "^${gatk_sample}" snp_counts_GATK.txt | awk '{print $3}')
  clair3_snps=$(grep "^${clair3_sample}" snp_counts_Clair3.txt | awk '{print $2}')
  
  gatk_unique=$((gatk_snps - sites_compared))
  clair3_unique=$((clair3_snps - sites_compared))
  
  echo -e "${pair}\tgDP20-40-GQ30_cDP10-20-GQ20\t${gatk_unique}\t${clair3_unique}\t${sites_compared}" >> snp_unique_summary.txt
done < gtcheck_summary-gDP20-40-GQ30-cDP10-20-GQ20.tsv

echo "Statistics completed! Results saved in snp_unique_summary.txt"
```

